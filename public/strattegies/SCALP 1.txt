//@version=6
strategy("BTC Scalping Strategy - Debug Version", overlay=true)

// ðŸ”¹ Î‘Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï†Î¯Î»Ï„ÏÎ¿Ï… ÏƒÏ…Î½ÎµÎ´ÏÎ¹ÏŽÎ½ Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Ï€Î¬Î½Ï„Î±
allowedSession = true  // Î‘Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ Ï„Î¿ session filtering

// ðŸ”¹ Î•Ï€Î¹Î»Î¿Î³Î® Liquidation Levels
liqSource = input.source(high, "Liquidation Reference")
liqLevel = request.security(syminfo.tickerid, "60", liqSource)

// ðŸ”¹ Î§ÏÎ¿Î½Î¹ÎºÏŒ Ï€Î»Î±Î¯ÏƒÎ¹Î¿ Î³Î¹Î± Ï„Î± Swing Points
swingLength = input(10, "Swing Length")

// ðŸ”¹ Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ Swing High ÎºÎ±Î¹ Swing Low
swingHigh = ta.highest(high, swingLength)
swingLow = ta.lowest(low, swingLength)

// ðŸ”¹ Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ Fibonacci Golden Pocket
fibLow = swingLow
fibHigh = swingHigh
goldenPocketLow = fibHigh - (fibHigh - fibLow) * 0.618
goldenPocketHigh = fibHigh - (fibHigh - fibLow) * 0.65

// ðŸ”¹ Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ Golden Wallet
goldenWalletLow = goldenPocketLow * 0.995  
goldenWalletHigh = goldenPocketHigh * 1.005  

// ðŸ”¹ Fixed Volume Profile (POC, VAH, VAL)
vp_window = input(100, "Volume Profile Window")
poc = ta.sma(volume, vp_window)
vah = ta.highest(high, vp_window)
val = ta.lowest(low, vp_window)

// ðŸ”¹ Î§Î±Î»Î¬ÏÏ‰ÏƒÎ· Ï„Ï‰Î½ Ï†Î¯Î»Ï„ÏÏ‰Î½ Cyper V2 (Î¼ÏŒÎ½Î¿ Fibonacci signals)
longCondition = ta.crossover(close, goldenPocketLow)  // ÎœÏŒÎ½Î¿ Fib 0.618 
shortCondition = ta.crossunder(close, goldenPocketHigh)  // ÎœÏŒÎ½Î¿ Fib 0.65

// ðŸ”¹ Stop Loss ÏƒÏ„Î¿ Swing Low/High
stopLossLong = swingLow
stopLossShort = swingHigh

// ðŸ”¹ Î£Ï„ÏÎ±Ï„Î·Î³Î¹ÎºÎ® Î•Î¹ÏƒÏŒÎ´Î¿Ï… & Î•Î¾ÏŒÎ´Î¿Ï… (Ï‡Ï‰ÏÎ¯Ï‚ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿ÏÏ‚ sessions)
if longCondition
    strategy.entry("Long", strategy.long)
    strategy.exit("Exit Long", from_entry="Long", stop=stopLossLong)

if shortCondition
    strategy.entry("Short", strategy.short)
    strategy.exit("Exit Short", from_entry="Short", stop=stopLossShort)

// ðŸ”¹ Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Fibonacci Golden Pocket ÏƒÏ„Î¿ Chart
plot(nz(goldenPocketLow), title="Fib 0.618", color=color.green, linewidth=2, trackprice=true)
plot(nz(goldenPocketHigh), title="Fib 0.65", color=color.blue, linewidth=2, trackprice=true)

// ðŸ”¹ Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Golden Wallet Ï‰Ï‚ Î¶ÏŽÎ½Î·
bgcolor(close > goldenWalletLow and close < goldenWalletHigh ? color.new(color.yellow, 90) : na)

// ðŸ”¹ Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Fixed Volume Profile ÏƒÏ„Î¿ Chart
plot(poc, title="Point of Control", color=color.red, linewidth=2, trackprice=true)
plot(vah, title="Value Area High", color=color.blue, linewidth=2, trackprice=true)
plot(val, title="Value Area Low", color=color.green, linewidth=2, trackprice=true)

// ðŸ”¹ Debugging Logs Î³Î¹Î± Î½Î± Î´Î¿ÏÎ¼Îµ Î±Î½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÏƒÏ…Î½Î¸Î®ÎºÎµÏ‚ ÎµÎ¹ÏƒÏŒÎ´Î¿Ï…
log.info("\n=== DEBUG INFO ===" +
         "\nClose price: {0}" +
         "\nGolden Pocket Low: {1}" +
         "\nGolden Pocket High: {2}" +
         "\nPOC: {3}" +
         "\nVAH: {4}" +
         "\nVAL: {5}" +
         "\nLong Condition: {6}" +
         "\nShort Condition: {7}",
         close, goldenPocketLow, goldenPocketHigh, poc, vah, val, longCondition, shortCondition)
